---
title: "Cyclistic Case Study"
author: "Drew Radovich"
date: "2024-02-26"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

This is an RMarkdown file to walk through the Google Data Analyst Capstone Project: Cyclistic Case Study. The data for this study has been made available by Motivate International Inc. under this license.

Cyclistic is a bike-share company based in Chicago that provides over 5,800 bikes at 600 docking stations. To appeal to those who may not be able to use conventional two-wheel bicycles, Cyclistic offers hand tricycles, reclining bikes, and cargo bikes in addition to traditional bicycles. These services are used mostly by casual app users, but also by annual members.

For this case study, you are a junior data analyst who is part of the Cyclistic marketing analysts team, tasked with understanding the difference between casual and member use of Cyclistic bike shares. From this, your team will initiate a new marketing campaign aimed at converting casual users to annual members.

Key stakeholders of this project include:

Lily Moreno: your direct supervisor and manager of marketing. Moreno is in charge of developing campaigns and initiatives to promote use of the bike-share program.

Cyclistic marketing analytics team: you are part of this team who is responsible for collecting, analyzing, and reporting Cyclisitc ride-share data to inform marketing campaign recommendations.

Cyclistic executive team: they will approve or deny any recommended marketing program

Business Task: To analyze ride-share data and define key characteristics and distinctions in bike use for casual users and annual members.

In order to answer this business question, I will be using RStudio and the R programming language. I have chosen R because of it’s ability to handle large data sets and it’s ability to transform data and make visualizations. I have also chosen to use Tableau in order to better visualize my findings and condense information into a more comprehensible visual for stakeholders. To help my analysis in R, I will be utilizing the tidyverse, janitor, and lubridate packages.


```{r}
## Install required packages tidyverse, janitor, and lubridate
install.packages('tidyverse')
install.packages('janitor')
install.packages('lubridate')

## Load packages for use
library(tidyverse)
library(janitor)
library(lubridate)
```

To start analyzing, I downloaded the 2023 ride-share data here. Since these files are in .csv format, I can add them to my R environment with the read.csv function. This is also an opportunity to clarify the names of the files to aid in analysis.

```{r}
##Adding a clear name for data <- Importing .csv file
Jan2023 <- read.csv("2023_trip_data/2023_01.csv")
Feb2023 <- read.csv("2023_trip_data/2023_02.csv")
Mar2023 <- read.csv("2023_trip_data/2023_03.csv")
Apr2023 <- read.csv("2023_trip_data/2023_04.csv")
May2023 <- read.csv("2023_trip_data/2023_05.csv")
Jun2023 <- read.csv("2023_trip_data/2023_06.csv")
Jul2023 <- read.csv("2023_trip_data/2023_07.csv")
Aug2023 <- read.csv("2023_trip_data/2023_08.csv")
Sep2023 <- read.csv("2023_trip_data/2023_09.csv")
Oct2023 <- read.csv("2023_trip_data/2023_10.csv")
Nov2023 <- read.csv("2023_trip_data/2023_11.csv")
Dec2023 <- read.csv("2023_trip_data/2023_12.csv")
```

To make sure the data is reliable and can be analyzed as a whole, I want to check that each table has identical column names and data types. This can be done with the str() function.

```{r}
## Checking each file for compatibility to merge into one dataset
str(Jan2023)
str(Feb2023)
str(Mar2023)
str(Apr2023)
str(May2023)
str(Jun2023)
str(Jul2023)
str(Aug2023)
str(Sep2023)
str(Oct2023)
str(Nov2023)
str(Dec2023)
```

Since each table contain the same data columns and types, they can be merged into one data drame.

```{r}
## Create new dataframe using bind_rows
merged_trips <- bind.rows(Jan2023, Feb2023, Mar2023, Apr2023, May2023, Jun2023, Jul2023, Aug2023, Sep2023, Oct2023, Nov2023, Dec2023)
```

Now that all of the data is in one data frame, we can begin to ensure that our data is clean by removing duplicates and verifying or removing empty data points. It is important to clean data and make sure that data types are equivalent so that further analysis is as accurate as possible.

```{r}
## Clean data frame by removing spaces, parentheses, camelCase, etc.
merged_trips <- clean_names(merged_trips)

## Remove empty columns and rows
remove_empty(merged_trips, which = c())
```

In order to better understand ride-share usage, I want to look at usage on the hourly, daily, and monthly scale. I believe this will provide better insights to how casual and annual members use the ride-share program.

```{r}
## Calculate day of the week using wday()
merged_trips$day_of_week<- wday(merged_trips$started_at, TRUE, TRUE)

## Calculate the start hour for trips using POSIXct
merged_trips$start_hour <- format(as.POSIXct(merged_trips$started_at), "%H")

## Extract Month
merged_trips$month <- format(as.POSIXct(merged_trips$started), '%B')
```

Next, I will calculate time for each individual trip using the start_time and end_time columns of my data frame. This will allow me to further filter the data to eliminate trips with no duration that may have been cancelled by users or failed to accurately report data.

```{r}
## Calculate trip duration
merged_trips$trip_duration <- difftime(merged_trips$ended_at, merged_trips$started_at, units = c('secs'))
 
## Filter out rides with zero-second durations
cleaned_trips <- merged_trips[!(merged_trips$trip_duration = 0) , ]
```

Now that the cleaning is complete, I can start to explore the data and analyze for insights.

First, I want to check how ride-share use varies throughout the week by member type. I believe that annual members are more likely to use the ride-share for commuting purposes, meaning that member trips should outnumber and be more consistent on weekdays (Monday through Friday) and casual user trips should outnumber annual members on the weekend (Saturday and Sunday).

```{r}
## Plot number of rides by member type, options(scipen = ) is used to remove scientific value from results
options(scipen = 999)
ggplot(data = cleaned_trips) +
aes(x = day_of_week, fill = member_casual) +
geom_bar(position = 'dodge') +
labs(x = 'Day of Week', y = 'Number of Trips', fill = 'Member Type', title = 'Number of Rides per Day of Week')

ggsave("number_of_rides_per_day_of_week.png")
```

Now I want to check trips by month.

```{r}
## Plot number of trips by member type per month
ggplot(data = cleaned_trips) +
aes(x = month, fill = member_casual) +
geom_bar(position = 'dodge') +
labs(x = 'Month', y = 'Number of Trips', fill = 'Member Type', title = 'Number of Trips per Month')

ggsave("number_of_trips_per_month.png")
```

Next, I want to explore trips on a micro level and look at the starting hours of each trip. This should further support my hypothesis about annual members using Cyclistic bikes for commuting purposes. This will be explained further in the analysis section of this project.

```{r}
## Plot trips per weekday by starting hour
ggplot(data = cleaned_trips) +
aes(x = start_hour, fill = member_casual) +
geom_bar() +
facet_wrap(~day_of_week) +
labs(x = 'Starting Hour', y = 'Number of Trips', fill = 'Member Type', title = 'Trips by Start Hour') +
theme(axis.text = element_text(size = 5))

ggsave("trips_by_start_hour.png")
```

I also calculated the average trip duration for every day. This data can be extremely helpful in understanding the purpose each member type derives from using the ride-share.

```{r}
## Find the average trip duration 
average_trips <- aggregate(cleaned_trips$trip_duration, list(cleaned_trips$member_casual, cleaned_trips$day_of_week), FUN = mean)

View(average_trips)
```

Since aggregate() creates a table with placeholder column names, I want to rename the columns to make it easier to understand and analyze.

```{r}
## Rename the column names to make analysis easier
colnames(average_trips) <- c('member_type', 'day_of_week', 'average_duration')
```

I want to plot this data using ggplot(), but since the data type <difftime> cannot be used, I will need to convert the data type of the average_duration column to <numeric>.

```{r}
## Convert data types for use in ggplot, since <difftime> cannot be used
average_trips$day_of_week <- as.character(average_trips$day_of_week)

average_trips$average_duration <- as.numeric(average_trips$average_duration, units = 'secs')

print(average_trips)

## Create a plot showing the average trip duration throughout the week
ggplot(average_trips2, aes(x = average_duration, y = day_of_week, fill = member_type)) +
+    geom_col(position = 'dodge') +
+    labs(x = 'Average Duration', y = 'Day of Week', fill = 'Member Type', title = 'Average Trip Duration per Week Day')
```

Now that I have more insight into how Cyclistic bikes are used, I want to explore where they are used. This information can help dictate which locations should be targeted for marketing based on the number of trips that occur.

```{r}
## Use descriptive analysis to find the most popular start and end stations for members and casual

## Most popular end stations for members
member_trips <- cleaned_trips[cleaned_trips$member_casual == 'member',]

end_station_counts <- member_trips$end_station_name %>% table() %>% sort(decreasing = TRUE)

head(end_station_counts, 10)

## Most popular start stations for members
member_trips <- cleaned_trips[cleaned_trips$member_casual == 'member',]

start_station_counts <- member_trips$start_station_name %>% table() %>% sort(decreasing = TRUE)

head(start_station_counts, 10)

## Most popular end stations for casual users
casual_trips <- cleaned_trips[cleaned_trips$member_casual == 'casual',]

end_station_counts2 <- casual_trips$end_station_name %>% table() %>% sort(decreasing = TRUE)

head(end_station_counts2, 10)

## Most popular start stations for casual users
casual_trips <- cleaned_trips[cleaned_trips$member_casual == 'casual',]

start_station_counts2 <- casual_trips$start_station_name %>% table() %>% sort(decreasing = TRUE)

head(start_station_counts2, 10)
```